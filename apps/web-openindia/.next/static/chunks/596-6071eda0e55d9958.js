"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[596],{4596:function(e,t,r){r.r(t),r.d(t,{CoursePlayer:function(){return m},PlayerShell:function(){return s},default:function(){return p},selectCaptionCue:function(){return o},useABLoop:function(){return u},useBookmarks:function(){return c},useCaptions:function(){return a},useNotes:function(){return d}});var n=r(6688),l=r(4567),i=r(1992);function o(e,t,r){let n=e.find(e=>t>=e.start&&t<e.end);if(n)return n;let l=r/1e3;return e.find(e=>Math.abs(t-e.start)<=l)||null}function a(e){let{cues:t,videoRef:r,enabled:n,driftThreshold:i}=e,[a,s]=(0,l.useState)(null);return(0,l.useEffect)(()=>{let e;let l=r.current;if(!l||!n){s(null);return}let a=()=>{let r=o(t,l.currentTime,i);s(e=>e===r?e:r),e=requestAnimationFrame(a)};return e=requestAnimationFrame(a),()=>cancelAnimationFrame(e)},[r,t,n,i]),a}let s=e=>{let{srcEn:t,srcHi:r,captions:o=[],glossary:s=[],initialLanguage:u="en",driftCorrectionMs:c=120,className:d}=e,m=(0,l.useRef)(null),[h,p]=(0,l.useState)(u),[f,x]=(0,l.useState)(!0),[y,g]=(0,l.useState)(!1),v="en"===h?t:r||t;(0,l.useEffect)(()=>{let e=m.current;if(e){if(e.canPlayType("application/vnd.apple.mpegurl")){e.src=v;return}if(i.ZP.isSupported()){let t=new i.ZP;return t.loadSource(v),t.attachMedia(e),()=>t.destroy()}e.src=v}},[v]);let k=a({cues:o,videoRef:m,enabled:f,driftThreshold:c}),j=(0,l.useMemo)(()=>{let e=new Map;return s.forEach(t=>e.set(t.term.toLowerCase(),t)),e},[s]),w=(0,l.useMemo)(()=>{if(!k)return null;let e=k.text.split(/(\s+)/).map((e,t)=>{let r=j.get(e.toLowerCase());return r?(0,n.jsx)("span",{"data-term":r.term,className:"player-term",style:{cursor:"pointer",textDecoration:"underline dotted"},children:e},t):e});return(0,n.jsx)("span",{children:e})},[k,j]);(0,l.useEffect)(()=>{let e=e=>{let t=m.current;t&&(" "===e.key?(e.preventDefault(),t.paused?t.play():t.pause()):"j"===e.key.toLowerCase()?t.currentTime=Math.max(0,t.currentTime-5):"k"===e.key.toLowerCase()?t.paused?t.play():t.pause():"l"===e.key.toLowerCase()?t.currentTime=t.currentTime+5:"c"===e.key.toLowerCase()?x(e=>!e):"g"===e.key.toLowerCase()&&g(e=>!e))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);let C=(0,l.useCallback)(e=>{let t=e.target.closest("[data-term]");if(t){let e=t.getAttribute("data-term");e&&(g(!0),j.get(e.toLowerCase()))}},[j]);return(0,n.jsxs)("div",{className:d,"data-player-shell":!0,children:[(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("video",{ref:m,controls:!0,style:{width:"100%",maxHeight:500}}),(0,n.jsxs)("div",{style:{position:"absolute",top:8,left:8,display:"flex",gap:8},children:[(0,n.jsxs)("button",{onClick:()=>p(e=>"en"===e?"hi":"en"),"aria-label":"toggle-language",children:["Lang: ",h]}),(0,n.jsxs)("button",{onClick:()=>x(e=>!e),"aria-label":"toggle-captions",children:["CC ",f?"On":"Off"]}),s.length>0&&(0,n.jsx)("button",{onClick:()=>g(e=>!e),"aria-label":"toggle-glossary",children:"Glossary"})]}),f&&k&&(0,n.jsx)("div",{onClick:C,"aria-live":"polite",style:{position:"absolute",bottom:40,width:"100%",textAlign:"center",color:"white",textShadow:"0 0 4px black",fontSize:18},children:w})]}),y&&(0,n.jsxs)("aside",{"aria-label":"glossary",style:{marginTop:12,border:"1px solid #ddd",padding:8,maxHeight:200,overflow:"auto"},children:[(0,n.jsx)("h4",{style:{margin:"4px 0"},children:"Glossary"}),(0,n.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:s.map(e=>(0,n.jsxs)("li",{style:{marginBottom:4},children:[(0,n.jsx)("strong",{children:e.term}),": ",e.definition]},e.term))})]})]})};function u(){let[e,t]=(0,l.useState)(null),[r,n]=(0,l.useState)(null),[i,o]=(0,l.useState)(!1);return{a:e,b:r,setA:t,setB:n,enabled:i,toggle:()=>o(e=>!e),clear:()=>{t(null),n(null),o(!1)}}}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,r]=(0,l.useState)(e);return{bookmarks:t,add:e=>r(t=>[...t,e].sort((e,t)=>e.time-t.time)),remove:e=>r(t=>t.filter(t=>t.time!==e))}}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,r]=(0,l.useState)(e);return{notes:t,add:e=>r(t=>[...t,e].sort((e,t)=>e.time-t.time)),remove:e=>r(t=>t.filter(t=>t.time!==e))}}let m=e=>{let{src:t,poster:r,captions:o=[],transcript:a=[],initialBookmarks:s,initialNotes:m,onBookmarkAdd:p,onNoteAdd:f,className:x}=e,y=(0,l.useRef)(null),{a:g,b:v,setA:k,setB:j,enabled:w,toggle:C,clear:b}=u(),{bookmarks:T,add:S}=c(s),{notes:L,add:E}=d(m);(0,l.useEffect)(()=>{let e=y.current;if(e){if(e.canPlayType("application/vnd.apple.mpegurl"))e.src=t;else if(i.ZP.isSupported()){let r=new i.ZP;return r.loadSource(t),r.attachMedia(e),()=>r.destroy()}else e.src=t}},[t]),(0,l.useEffect)(()=>{let e=y.current;if(!e)return;let t=()=>{w&&null!=g&&null!=v&&(e.currentTime<g&&(e.currentTime=g),e.currentTime>=v&&(e.currentTime=g))};return e.addEventListener("timeupdate",t),()=>e.removeEventListener("timeupdate",t)},[g,v,w]),(0,l.useEffect)(()=>{let e=e=>{let t=y.current;t&&(" "===e.key?(e.preventDefault(),t.paused?t.play():t.pause()):"a"===e.key.toLowerCase()?k(t.currentTime):"b"===e.key.toLowerCase()?j(t.currentTime):"l"===e.key.toLowerCase()?C():"ArrowRight"===e.key?t.currentTime+=5:"ArrowLeft"===e.key&&(t.currentTime-=5))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[C,k,j]);let M=(0,l.useMemo)(()=>o.map((e,t)=>(0,n.jsx)("track",{label:e.label,kind:"subtitles",srcLang:e.srclang,src:e.src,default:e.default},t)),[o]);return(0,n.jsxs)("div",{className:x,children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("video",{ref:y,poster:r,controls:!0,style:{width:"100%",maxHeight:480},children:M}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8},children:[(0,n.jsx)("button",{onClick:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.play()},children:"Play"}),(0,n.jsx)("button",{onClick:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.pause()},children:"Pause"}),(0,n.jsx)("button",{onClick:()=>{var e;return k((null===(e=y.current)||void 0===e?void 0:e.currentTime)||0)},children:"Set A"}),(0,n.jsx)("button",{onClick:()=>{var e;return j((null===(e=y.current)||void 0===e?void 0:e.currentTime)||0)},children:"Set B"}),(0,n.jsxs)("button",{onClick:C,children:[w?"Disable":"Enable"," Loop"]}),(0,n.jsx)("button",{onClick:b,children:"Clear Loop"}),(0,n.jsx)("button",{onClick:()=>{let e=y.current;if(!e)return;let t={time:Math.floor(e.currentTime)};S(t),null==p||p(t)},children:"Bookmark"}),(0,n.jsx)("button",{onClick:()=>{let e=y.current;if(!e)return;let t=prompt("Note");if(t&&t.trim()){let r={time:Math.floor(e.currentTime),note:t.trim()};E(r),null==f||f(r)}},children:"Note"})]})]}),a.length>0&&(0,n.jsxs)("div",{style:{marginTop:16},children:[(0,n.jsx)("h4",{children:"Transcript"}),(0,n.jsx)("ul",{style:{maxHeight:160,overflow:"auto"},children:a.map((e,t)=>(0,n.jsx)("li",{children:(0,n.jsxs)("button",{onClick:()=>{y.current&&(y.current.currentTime=e.start)},children:["[",h(e.start),"] ",e.text]})},t))})]}),T.length>0&&(0,n.jsxs)("div",{style:{marginTop:16},children:[(0,n.jsx)("h4",{children:"Bookmarks"}),(0,n.jsx)("ul",{children:T.map((e,t)=>(0,n.jsx)("li",{children:(0,n.jsxs)("button",{onClick:()=>y.current&&(y.current.currentTime=e.time),children:[h(e.time)," ",e.note?"- ".concat(e.note):""]})},t))})]}),L.length>0&&(0,n.jsxs)("div",{style:{marginTop:16},children:[(0,n.jsx)("h4",{children:"Notes"}),(0,n.jsx)("ul",{children:L.map((e,t)=>(0,n.jsx)("li",{children:(0,n.jsxs)("button",{onClick:()=>y.current&&(y.current.currentTime=e.time),children:[h(e.time)," - ",e.note]})},t))})]})]})};function h(e){let t=Math.floor(e%60).toString().padStart(2,"0"),r=Math.floor(e/60%60).toString().padStart(2,"0"),n=Math.floor(e/3600).toString().padStart(2,"0");return"00"!==n?"".concat(n,":").concat(r,":").concat(t):"".concat(r,":").concat(t)}var p=m}}]);